workflows:
  build-and-deploy:
    name: GÃ¼venli Okul Otomasyon Sistemi Mobil Uygulamasi
    max_build_duration: 180  # Increased duration
    instance_type: mac_mini_m2
    scripts:
      - name: Install .NET SDK
        script: |
          wget https://dot.net/v1/dotnet-install.sh
          chmod +x dotnet-install.sh
          ./dotnet-install.sh --install-dir $CM_BUILD_DIR/dotnet

      - name: Install MAUI Workloads
        script: |
          $CM_BUILD_DIR/dotnet/dotnet workload install maui android ios --source https://aka.ms/dotnet6/nuget/index.json || { echo "MAUI installation failed"; exit 1; }

      - name: Build the app
        script: |
          $CM_BUILD_DIR/dotnet/dotnet build goosorgtr_mobil.csproj -c Release

      - name: Publish the app
        script: |
          $CM_BUILD_DIR/dotnet/dotnet publish goosorgtr_mobil.csproj -c Release -o output_directory
